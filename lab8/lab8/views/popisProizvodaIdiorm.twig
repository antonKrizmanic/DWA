{% extends "fantasticBeastsBasic.twig" %}

{% block content %}
<div class="form-inline">
	<div class="form-group">
		<label for="search">Trazeni pojam:</label>
		<input type="text" id="search" name="search" placeholder="Upisi trazeni pojam" class="form-control ">
	</div>

	<a href="javascript:void()" onclick="deleteCookie();" class="btn btn-primary">Isprazni </a>
</div>

<table class="table table-striped" id="tablica">
	<thead>
    	<tr>
        	<th>Naziv proizvoda</th>
        	<th>Vrsta proizvoda</th>
        	<th>Zivotinja</th>
        	<th>Opis</th>
        	<th>Cijena</th>
					<th>Dodaj</th>
        </tr>
    </thead>
    <tbody id="tbody">

	</tbody>
</table>
<div id="ajax"></div>
<script type="text/javascript">
	$(document).ready(function(){
      var xhttp = new XMLHttpRequest();
	  xhttp.onreadystatechange = function() {
	    if (xhttp.readyState == 4 && xhttp.status == 200) {
	      var proizvodi = JSON.parse(xhttp.responseText);
	      for(i=0;i<proizvodi.length;i++){
	      	document.getElementById("tbody").innerHTML += "<tr><td>"+proizvodi[i].Naziv+"</td><td>"	+proizvodi[i].Vrsta+"</td><td>"	+proizvodi[i].Zivotinja+"</td><td>"	+proizvodi[i].Opis+"</td><td>"+
					proizvodi[i].Cijena+"</td><td><input type='submit' value='spremi' class='btn btn-info' onclick='setCookie(\"shop\",getCookie(\"shop\")+\",\"+\""+proizvodi[i].id+"\", 1)'></input></td></tr>";
	      }
	    }
	  };
	  xhttp.open("GET", "logic/popisProizvoda.php", true);
	  xhttp.send();
    });




	$("#search").keyup(function(){
		/*javascript*/
		/*var unos=document.getElementById("search").value;
		var trs = document.getElementsByTagName("tr");*/
		/*jquery*/
		/*var unos=$("#search").val();
		var trs=$("tr");
		for(var i=1;i<trs.length;i++){
			var c=trs[i].innerHTML.search(unos);
			if(c==-1){
				trs[i].style.display="none";
			}
		}*/

			var unos=$("#search").val();
			var xhttp = new XMLHttpRequest();
			xhttp.onreadystatechange = function() {
				if (xhttp.readyState == 4 && xhttp.status == 200) {
					var proizvodi = JSON.parse(xhttp.responseText);
					$("tbody").children().remove();
					for(i=0;i<proizvodi.length;i++){
						document.getElementById("tbody").innerHTML += "<tr><td>"+proizvodi[i].Naziv+"</td><td>"	+proizvodi[i].Vrsta+"</td><td>"	+proizvodi[i].Zivotinja+"</td><td>"	+proizvodi[i].Opis+"</td><td>"+
						proizvodi[i].Cijena+"</td><td><input type='submit' value='spremi' class='btn btn-info' onclick='setCookie(\"shop\",getCookie(\"shop\")+\",\"+\""+proizvodi[i].id+"\", 1)'></input></td></tr>";
					}
				}
			};
		xhttp.open("GET", "logic/popisProizvoda.php?var="+unos+"", true);
		xhttp.send();

	})

	function setCookie(cname, cvalue, exdays) {
		var d = new Date();
		d.setTime(d.getTime() + (exdays*24*60*60*1000));
		var expires = "expires="+d.toUTCString();
		document.cookie = cname + "=" + cvalue + "; " + expires;
	}
	function getCookie(cname) {
		  	var name = cname + "=";
		var ca = document.cookie.split(';');
	    for(var i=0; i<ca.length; i++) {
			var c = ca[i];
			while (c.charAt(0)==' ') c = c.substring(1);
			if (c.indexOf(name) == 0) return c.substring(name.length,c.length);
		}
		return "";
	}
	function deleteCookie(){
		document.cookie = "shop=; expires=Thu, 01 Jan 1970 00:00:00 UTC";
	}
</script>
{% endblock %}
